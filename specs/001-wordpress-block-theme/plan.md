# Implementation Plan: RenalInfoLK Web - WordPress Block Theme

**Branch**: `001-wordpress-block-theme` | **Date**: 2025-11-11 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-wordpress-block-theme/spec.md`

**Note**: This plan was generated by the `/speckit.plan` command based on the feature specification and design files (codes.html + screen.png).

## Summary

Convert provided design files into a fully functional WordPress block theme for a pediatric nephrology medical knowledge-sharing platform. The theme will use Full Site Editing (FSE), implement pixel-perfect responsive design from reference files, support dark mode with user toggle, include 15+ reusable block patterns, achieve WCAG 2.1 Level AA accessibility, and target 90+ Lighthouse performance scores. Primary technical approach: Pure block theme using theme.json v3 for all styling (no build process), inline SVG icons (no CDN), slide-in mobile menu drawer, and responsive CSS Grid layouts.

## Technical Context

**WordPress Version**: 6.7+ (required), tested up to 6.8
**PHP Version**: 7.2+ (minimum WordPress requirement)
**Theme Type**: Block Theme (Full Site Editing)
**Schema Version**: theme.json v3 (WordPress 6.8 schema at https://schemas.wp.org/wp/6.8/theme.json)
**Primary Files**: theme.json, templates/*.html, patterns/*.php, styles/*.json, functions.php
**Testing**: WordPress Site Editor, Lighthouse (performance/accessibility), WAVE/Axe DevTools (accessibility), responsive viewports (320px-2560px), keyboard navigation
**Text Domain**: renalinfo-web
**Build Process**: None (pure block theme - no Node.js, compilation, or bundling required)
**Performance Goals**: Fluid typography with clamp(), optimized images (WebP + fallbacks), lazy loading, <50KB CSS, <30KB JS, Lighthouse 90+ desktop/80+ mobile
**Constraints**: WCAG 2.1 Level AA, GPL-2.0-or-later license, WordPress coding standards (PHPCS), theme.json schema validation
**Scale/Scope**: 3 style variations (default, high contrast, dark mode), 15+ block patterns (heroes, CTAs, headers, footers, content sections), 7 templates, 3 template parts, 10+ Material Symbol SVG icons

**Design Reference Files:**
- codes.html: Complete HTML/CSS implementation with Tailwind classes, Material Symbols icons, dark mode support
- screen.png: Visual design showing layout, typography, colors, spacing, component arrangement

**Key Design Specifications Extracted:**
- **Font**: Lexend (Google Fonts) - weights 400, 500, 600, 700, 800, 900
- **Colors**:
  - Primary: #359EFF (blue)
  - Primary Dark: #2E4F64
  - Secondary: #BDE0FE (light blue)
  - Green-Blue: #006D77
  - Accent: #FFD28E (peach)
  - CTA Yellow: #FFC300
  - Background Light: #f5f7f8
  - Background Dark: #0f1923
  - Text Light: #4A4A4A
  - Text Dark: #E0E0E0
  - Footer Dark: #1C2541
  - Accent Dark: #1d2c33
- **Icons**: Material Symbols (health_and_safety, article, play_circle, image, campaign, search, menu, arrow_forward, location_on, call, mail, family_restroom, medical_information)
- **Layout**:
  - Header: Gradient from #006D77 to #1C2541, sticky
  - Hero: Two-column with text + illustration
  - Content grids: 3-column on desktop, responsive
  - Footer: Multi-column with contact info
- **Typography Scale**: Base 14-16px, headings 24-48px, responsive with clamp()
- **Spacing**: Consistent 16-64px spacing system
- **Responsive Breakpoints**: 768px (mobile/tablet), 1024px (tablet/desktop)

**Clarifications from Session:**
1. Mobile menu: Slide-in side panel (drawer) from right with backdrop, dismissible by tapping outside
2. Dark mode: Full implementation with toggle switch in header, localStorage persistence
3. Icons: Inline SVG (no CDN), Material Symbols SVGs embedded in patterns
4. Search: Standard WordPress search form (submit to search.php template)
5. Archive grid: Responsive CSS Grid with auto-fill (1-4 columns dynamically)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

**WordPress Block Theme Principles Compliance:**

- [x] **Schema Compliance**: theme.json will validate against WP 6.8 schema (version: 3, all properties conform to schema)
- [x] **Block Markup Exclusivity**: All templates/patterns use block markup only (<!-- wp:blockName --> syntax, no custom HTML)
- [x] **theme.json as Source of Truth**: All styling centralized in theme.json (colors, typography, spacing via presets, no hardcoded values in templates)
- [x] **Minimal PHP Logic**: functions.php limited to WordPress hooks only (register patterns, enqueue assets, theme support - no custom post types or business logic)
- [x] **Template Hierarchy**: Templates follow WordPress naming (index.html required, standard names for single, page, archive, search, 404, home)
- [x] **Accessibility (WCAG 2.1 AA)**: Color contrast verified (4.5:1+ for text), keyboard navigation supported, semantic markup via blocks, ARIA labels where needed
- [x] **Pattern-Based Composition**: Reusable structures as patterns (heroes, CTAs, headers, footers in /patterns/ directory, kebab-case naming)

**Violations**: None - Standard WordPress block theme implementation fully compliant with constitution principles.

## Project Structure

### Documentation (this feature)

```text
specs/001-wordpress-block-theme/
├── plan.md              # This file (/speckit.plan output)
├── spec.md              # Feature specification (already exists)
├── research.md          # Phase 0 output - design system extraction, best practices
├── data-model.md        # Phase 1 output - WordPress data structures (posts, pages, taxonomies)
├── quickstart.md        # Phase 1 output - theme installation and customization guide
├── contracts/           # Phase 1 output - theme.json schema reference, block pattern contracts
│   ├── theme-json-structure.md
│   ├── pattern-contracts.md
│   └── template-hierarchy.md
└── checklists/
    └── requirements.md  # Specification validation checklist (already exists)
```

### Source Code (repository root)

```text
# RenalInfoLK Web WordPress Block Theme Structure
/
├── assets/
│   ├── css/
│   │   └── editor-style.css     # Site Editor specific styles (if needed)
│   ├── fonts/
│   │   ├── lexend-variable.woff2    # Lexend variable font (200-900 weights)
│   │   └── LICENSE-fonts.txt        # Font licensing (SIL OFL)
│   └── images/
│       ├── hero-illustration.webp   # Hero section illustration from design
│       ├── hero-illustration.png    # Fallback
│       ├── logo.svg                 # Pediatric Nephrology Unit logo
│       └── placeholder-*.webp       # Pattern placeholder images
├── parts/                           # Template parts (.html files)
│   ├── header.html                  # Site header with nav, search, dark mode toggle
│   ├── footer.html                  # Site footer with multi-column layout
│   └── sidebar.html                 # Sidebar for blog posts (optional)
├── patterns/                        # Block patterns (.php files)
│   ├── hero-primary.php             # Main hero with illustration (homepage)
│   ├── hero-simple.php              # Simple text-only hero
│   ├── hero-centered.php            # Centered hero with CTA
│   ├── cta-webinar.php              # Webinar announcement banner
│   ├── cta-boxed.php                # Boxed call-to-action
│   ├── cta-inline.php               # Inline CTA with buttons
│   ├── content-resources-grid.php   # Featured resources 3-column grid
│   ├── content-news-grid.php        # Latest news 3-column grid with images
│   ├── content-two-column.php       # Text + image two-column section
│   ├── header-primary.php           # Main header with gradient
│   ├── header-simple.php            # Simple header variation
│   ├── footer-primary.php           # Multi-column footer
│   ├── footer-minimal.php           # Minimal footer
│   ├── hidden-post-meta.php         # Post metadata component
│   └── hidden-search-form.php       # Search form component
├── styles/                          # Style variations (.json files)
│   ├── default.json                 # Default medical professional style (already in theme.json)
│   ├── high-contrast.json           # High contrast variation for accessibility
│   └── dark-mode.json               # Dark mode color palette (activated by JS toggle)
├── templates/                       # Block templates (.html files - REQUIRED)
│   ├── index.html                   # MANDATORY fallback template
│   ├── home.html                    # Homepage with hero + featured content
│   ├── single.html                  # Blog post single view
│   ├── page.html                    # Static page template
│   ├── archive.html                 # Blog archive with grid layout
│   ├── search.html                  # Search results template
│   └── 404.html                     # Error page with helpful navigation
├── functions.php                    # Theme setup (minimal PHP)
│   # - Register theme support (block styles, editor styles)
│   # - Enqueue assets (style.css, dark mode toggle JS)
│   # - Register pattern categories (renalinfo_web_page, renalinfo_web_cta)
│   # - Register block styles (if custom styles needed)
├── style.css                        # Theme metadata header + minimal global CSS
│   # Theme Name: RenalInfoLK Web
│   # Description: WordPress block theme for pediatric nephrology platform
│   # Version: 1.0.0
│   # Requires at least: 6.7
│   # Tested up to: 6.8
│   # Requires PHP: 7.2
│   # License: GPL-2.0-or-later
│   # Text Domain: renalinfo-web
├── theme.json                       # Global configuration (PRIMARY - 800+ lines)
│   # - Schema: version 3
│   # - Settings: colors (11 presets), typography (Lexend font, 7 sizes), spacing (8 presets), layout (contentSize: 1200px, wideSize: 1440px)
│   # - Styles: elements (button, link, heading), blocks (core/button, core/navigation, etc.)
│   # - customTemplates: [] (if any custom templates)
│   # - templateParts: [header, footer, sidebar]
├── screenshot.png                   # Theme screenshot (1200x900px) - homepage view
├── README.txt                       # WordPress.org theme directory format
│   # Installation instructions
│   # Style variation descriptions
│   # Credits and licenses (Lexend font SIL OFL, Material Symbols Apache 2.0, images CC0)
│   # Changelog
└── LICENSE.txt                      # GPL-2.0-or-later license text
```

**Structure Decision**: Standard WordPress block theme structure is used with no modifications. The theme follows the canonical directory layout required by WordPress for block themes with FSE support. All styling is centralized in theme.json (no separate Sass/Less build process), patterns are organized by type (hero, cta, content, hidden), and templates follow WordPress template hierarchy. The /assets/ directory contains optimized fonts and images only. Dark mode implementation uses JavaScript (enqueued in functions.php) to toggle theme.json style variations via localStorage and class swapping.

## Complexity Tracking

> **No violations - this section is empty per constitution compliance.**

---

## Phase 0: Research & Design System Extraction

**Goal**: Extract design tokens from codes.html and screen.png, research WordPress block theme best practices, resolve all technical unknowns.

**Status**: Pending execution in research.md generation

**Key Research Tasks**:
1. Extract exact color palette from codes.html Tailwind config
2. Extract typography scale and font specifications
3. Extract spacing system and responsive breakpoints
4. Research Lexend font loading strategies (Google Fonts API vs self-hosted)
5. Research Material Symbols SVG extraction and optimization
6. Research WordPress dark mode toggle best practices
7. Research responsive CSS Grid auto-fill patterns for archive layouts
8. Research mobile slide-in drawer implementation in WordPress
9. Research WordPress search form block integration
10. Research theme.json fluid typography clamp() patterns

**Research Output**: research.md document with:
- Design token table (colors, typography, spacing, borders)
- Font loading strategy decision (self-hosted Lexend variable font recommended for performance)
- Icon SVG extraction process (Material Symbols GitHub repo)
- Dark mode toggle implementation pattern (localStorage + JS + theme.json style variation)
- Responsive grid implementation (CSS Grid auto-fill with minmax)
- Mobile menu implementation (CSS drawer + backdrop with WordPress navigation block)
- Best practices references (WordPress Theme Handbook, WP 6.8 block theme docs)

---

## Phase 1: Design Artifacts & Contracts

**Goal**: Generate theme.json structure, pattern contracts, template hierarchy documentation, quickstart guide.

**Status**: Pending execution after Phase 0

**Artifacts to Generate**:

### 1. data-model.md
WordPress uses standard post types and taxonomies - no custom data model needed for this theme.

**Content**:
- **Post**: Standard WordPress blog posts (title, content, featured image, excerpt, author, date, categories, tags)
- **Page**: Static pages (title, content, featured image)
- **Categories**: Medical topic organization (e.g., "Kidney Conditions", "Treatment Options", "Patient Resources", "Professional Guidelines")
- **Tags**: Article tagging for cross-referencing
- **Navigation Menus**: Primary menu (header), footer menu
- **Media**: Images optimized (WebP + PNG/JPEG fallbacks), lazy loading enabled

**Note**: No custom post types or taxonomies - theme provides presentation layer only per WordPress block theme principles.

### 2. contracts/theme-json-structure.md
Document theme.json structure with exact settings and styles sections.

**Content**:
- Schema reference: https://schemas.wp.org/wp/6.8/theme.json
- Settings structure:
  - `settings.color.palette`: 11 colors extracted from design (primary, primary-dark, secondary, green-blue, accent, cta-yellow, background-light, background-dark, text-light, text-dark, footer-dark)
  - `settings.typography.fontFamilies`: Lexend variable font with weights 400-900
  - `settings.typography.fontSizes`: 7 responsive sizes (xs: 14px, sm: 16px, md: clamp(18px, 2vw, 20px), lg: clamp(24px, 3vw, 32px), xl: clamp(32px, 4vw, 48px), xxl: clamp(48px, 5vw, 64px))
  - `settings.spacing.spacingSizes`: 8 presets (10-80 slugs with px and clamp values)
  - `settings.layout.contentSize`: 1200px, `wideSize`: 1440px
- Styles structure:
  - `styles.color.background`: background-light
  - `styles.color.text`: text-light
  - `styles.elements.button`: CTA styling (rounded-full, padding, hover states)
  - `styles.elements.link`: Color and hover behavior
  - `styles.elements.heading`: Font weights and sizes
  - `styles.blocks.core/button`: Button block customization
  - `styles.blocks.core/navigation`: Navigation styling
  - `styles.blocks.core/post-template`: Archive grid styling
- Template parts registration
- Custom template registration (if needed)

### 3. contracts/pattern-contracts.md
Document pattern structure, props, and usage for each pattern category.

**Content**:
- **Hero Patterns**: hero-primary, hero-simple, hero-centered
  - Props: heading, subheading, CTA button text/link, background color, image
  - Blocks used: core/group, core/heading, core/paragraph, core/buttons, core/button, core/image
  - Usage: Homepage, landing pages
- **CTA Patterns**: cta-webinar, cta-boxed, cta-inline
  - Props: heading, description, button text/link, accent color
  - Blocks used: core/group, core/heading, core/paragraph, core/buttons
  - Usage: Homepage, content pages
- **Content Patterns**: content-resources-grid, content-news-grid, content-two-column
  - Props: section heading, grid items (title, description, icon/image, link)
  - Blocks used: core/group, core/heading, core/columns, core/column, core/image, core/paragraph
  - Usage: Homepage, resource pages
- **Header Patterns**: header-primary, header-simple
  - Props: logo, navigation menu, search form, dark mode toggle
  - Blocks used: core/group, core/site-logo, core/navigation, core/search, custom HTML (dark mode toggle)
  - Usage: Header template part
- **Footer Patterns**: footer-primary, footer-minimal
  - Props: columns (Quick Links, Resources, Contact Info), copyright text
  - Blocks used: core/group, core/columns, core/column, core/heading, core/list, core/paragraph
  - Usage: Footer template part

### 4. contracts/template-hierarchy.md
Document WordPress template hierarchy and how theme templates map to page types.

**Content**:
- Template hierarchy flow: WordPress searches database → child theme → parent theme
- Template mapping:
  - `index.html`: Fallback for all page types (required)
  - `home.html`: Blog homepage (shows latest posts)
  - `single.html`: Individual blog post view
  - `page.html`: Static pages (About, Contact, etc.)
  - `archive.html`: Category, tag, date archives
  - `search.html`: Search results
  - `404.html`: Page not found error
- Template parts usage:
  - `parts/header.html`: Included in all templates via `<!-- wp:template-part {"slug":"header"} /-->`
  - `parts/footer.html`: Included in all templates via `<!-- wp:template-part {"slug":"footer"} /-->`
  - `parts/sidebar.html`: Optional, included in single.html for blog posts
- Pattern insertion in templates:
  - Homepage (`home.html`): hero-primary, cta-webinar, content-resources-grid, content-news-grid patterns
  - Static pages (`page.html`): Flexible content area for pattern insertion via Site Editor

### 5. quickstart.md
User-facing guide for theme installation, customization, and usage.

**Content**:
- **Installation**:
  1. Download theme ZIP file
  2. WordPress admin → Appearance → Themes → Add New → Upload Theme
  3. Click "Activate"
  4. Navigate to Appearance → Editor to customize
- **Customization**:
  - Colors: Site Editor → Styles → Colors (modify palette)
  - Typography: Site Editor → Styles → Typography (adjust font sizes, line heights)
  - Spacing: Site Editor → Styles → Layout (modify content width, padding)
  - Dark Mode: Toggle switch in site header (user preference saved in browser)
  - Style Variations: Site Editor → Styles → Browse Styles (default, high contrast, dark mode)
- **Creating Content**:
  - New Page: Pages → Add New → Insert patterns from pattern inserter
  - New Post: Posts → Add New → Write content with block editor
  - Featured Resources: Create posts in "Resources" category, add featured images
  - News Updates: Create posts in "News" category, add featured images
- **Navigation Menus**:
  - Appearance → Navigation → Create menu
  - Add pages/posts/custom links
  - Assign to "Primary" location (header) or "Footer" location
- **Troubleshooting**:
  - Dark mode not working: Clear browser cache, ensure JavaScript enabled
  - Patterns missing: Check WordPress version (6.7+ required)
  - Colors not updating: Clear WordPress cache, regenerate CSS
- **Credits & Licenses**:
  - Lexend font: SIL Open Font License
  - Material Symbols: Apache License 2.0
  - Theme code: GPL-2.0-or-later

---

## Phase 2: Implementation Tasks

**Note**: Task breakdown is generated by the `/speckit.tasks` command (NOT part of `/speckit.plan`). This section documents the expected task structure only.

**Expected Task Categories** (to be generated in tasks.md):

1. **Foundational Setup** (P0 - Priority 0, prerequisites)
   - Create theme directory structure
   - Create style.css with theme metadata
   - Create empty theme.json (v3 schema)
   - Create empty functions.php
   - Create README.txt
   - Add GPL-2.0-or-later LICENSE.txt

2. **Design System Implementation** (P1 - Priority 1, core MVP)
   - Extract and convert Lexend variable font to WOFF2
   - Add Lexend font to /assets/fonts/ with LICENSE
   - Define color palette in theme.json settings.color.palette (11 colors)
   - Define typography in theme.json settings.typography (Lexend, 7 sizes with clamp)
   - Define spacing in theme.json settings.spacing (8 presets with clamp)
   - Define layout in theme.json settings.layout (contentSize, wideSize)
   - Validate theme.json against WP 6.8 schema

3. **Template Creation** (P1)
   - Create index.html (mandatory fallback template)
   - Create home.html (blog homepage with hero + grids)
   - Create single.html (blog post template)
   - Create page.html (static page template)
   - Create archive.html (responsive CSS Grid layout)
   - Create search.html (search results with form)
   - Create 404.html (error page with navigation)
   - Register templates in theme.json if custom templates needed

4. **Template Parts Creation** (P1)
   - Create parts/header.html (logo, navigation, search, dark mode toggle)
   - Create parts/footer.html (multi-column footer with contact info)
   - Create parts/sidebar.html (optional blog sidebar)
   - Register template parts in theme.json templateParts section

5. **Block Pattern Creation** (P1)
   - Extract Material Symbols SVGs (11 icons) and optimize
   - Create hero-primary.php (main hero with illustration)
   - Create hero-simple.php and hero-centered.php
   - Create cta-webinar.php (announcement banner)
   - Create cta-boxed.php and cta-inline.php
   - Create content-resources-grid.php (3-column with icons)
   - Create content-news-grid.php (3-column with images)
   - Create content-two-column.php
   - Create header-primary.php and header-simple.php
   - Create footer-primary.php and footer-minimal.php
   - Create hidden-post-meta.php and hidden-search-form.php
   - Register pattern categories in functions.php

6. **Style Variations** (P2 - Priority 2, enhanced features)
   - Create styles/high-contrast.json (increased contrast colors)
   - Create styles/dark-mode.json (dark color palette)
   - Test style variations in Site Editor

7. **Dark Mode Toggle Implementation** (P2)
   - Create dark-mode-toggle.js (localStorage + class toggle)
   - Enqueue JavaScript in functions.php
   - Add toggle button SVG to header template part
   - Test dark mode persistence across page loads

8. **Mobile Menu Implementation** (P2)
   - Add mobile menu CSS (slide-in drawer, backdrop)
   - Add mobile menu JavaScript (open/close, dismiss on backdrop click)
   - Enqueue mobile menu assets in functions.php
   - Test responsive breakpoints (768px)
   - Test touch targets (44x44px minimum)

9. **Responsive Grid Implementation** (P2)
   - Add CSS Grid auto-fill styles to archive template
   - Test grid responsive behavior (1-4 columns)
   - Verify grid alignment and spacing

10. **Asset Optimization** (P2)
    - Optimize hero illustration (WebP + PNG fallback)
    - Optimize placeholder images for patterns
    - Create screenshot.png (1200x900px homepage view)
    - Add image licensing information to README.txt

11. **Accessibility Testing** (P3 - Priority 3, polish & validation)
    - Test color contrast with WAVE/Axe DevTools (4.5:1+ for text)
    - Test keyboard navigation (focus indicators visible)
    - Test screen reader with NVDA/VoiceOver
    - Verify heading hierarchy (h1-h6 proper order)
    - Verify ARIA labels on interactive elements
    - Add skip-to-content link if missing

12. **Performance Testing** (P3)
    - Run Lighthouse performance audit (target 90+ desktop, 80+ mobile)
    - Verify lazy loading on images below fold
    - Check CSS file size (<50KB)
    - Check JavaScript file size (<30KB)
    - Verify no render-blocking resources
    - Test on 3G throttled connection (FCP <1.5s, LCP <2.5s)

13. **WordPress Standards Validation** (P3)
    - Run WordPress Theme Check plugin (zero errors/warnings)
    - Run PHPCS with WordPress ruleset
    - Verify text domain consistency (renalinfo-web)
    - Verify function prefixes (renalinfo_web_)
    - Verify i18n (translatable strings wrapped)
    - Test theme.json schema validation

14. **Cross-Browser Testing** (P3)
    - Test in Chrome/Edge latest 2 versions
    - Test in Firefox latest 2 versions
    - Test in Safari (macOS/iOS) latest 2 versions
    - Test with JavaScript disabled (progressive enhancement)
    - Test on mobile Safari iOS and Chrome Android

15. **Documentation Completion** (P3)
    - Complete README.txt (installation, features, changelog, credits)
    - Add code comments in functions.php
    - Document customization points
    - Add font/icon licensing attributions
    - Create deployment documentation

16. **Final Packaging** (P3)
    - Create theme ZIP file
    - Verify ZIP structure (no hidden files, proper root directory)
    - Test installation from ZIP in fresh WordPress instance
    - Verify theme activates without errors
    - Verify Site Editor opens successfully

---

## Next Steps

1. **Execute Phase 0**: Run research tasks to generate research.md with design system extraction and best practices
2. **Execute Phase 1**: Generate data-model.md, contracts/, and quickstart.md based on research findings
3. **Update Agent Context**: Run agent context update script to add WordPress theme development guidance
4. **Generate Tasks**: Run `/speckit.tasks` to create tasks.md with prioritized, dependency-ordered implementation tasks
5. **Begin Implementation**: Start with P0 foundational tasks, progress through P1 core MVP, then P2/P3 enhancements

**Estimated Effort**: 40-60 hours total implementation time
- Phase 0 Research: 4-6 hours
- Phase 1 Design: 6-8 hours
- Phase 2 Implementation: 30-46 hours (P0: 2h, P1: 20-28h, P2: 8-12h, P3: 6-8h)
